{"version":3,"file":"page-CSzIpzYV.js","sources":["../../src/pages/contenedores/detalle/components/ContainerHeader.tsx","../../src/pages/contenedores/detalle/components/ContainerSummary.tsx","../../src/pages/contenedores/detalle/components/ContainerContentTable.tsx","../../src/pages/contenedores/detalle/components/ReverseLineModal.tsx","../../src/pages/contenedores/detalle/page.tsx"],"sourcesContent":["import { Link } from 'react-router-dom';\n\ninterface ContainerHeaderProps {\n  code: string;\n  tienda: string;\n  camion?: string;\n  status: string;\n  createdAt: string;\n  closedAt?: string | null;\n  createdByEmail?: string;\n}\n\nconst statusMap: Record<string, { bg: string; label: string }> = {\n  OPEN: { bg: 'bg-sky-100 text-sky-700', label: 'Abierto' },\n  CLOSED: { bg: 'bg-amber-100 text-amber-700', label: 'Cerrado' },\n  DISPATCHED: { bg: 'bg-emerald-100 text-emerald-700', label: 'Despachado' },\n};\n\nfunction formatDate(dateStr: string) {\n  // Guard against invalid dates\n  const date = new Date(dateStr);\n  if (Number.isNaN(date.getTime())) {\n    return 'Fecha no válida';\n  }\n  return date.toLocaleDateString('es-ES', {\n    day: '2-digit',\n    month: 'short',\n    year: 'numeric',\n    hour: '2-digit',\n    minute: '2-digit',\n  });\n}\n\nexport default function ContainerHeader({\n  code,\n  tienda,\n  camion,\n  status,\n  createdAt,\n  closedAt,\n  createdByEmail,\n}: ContainerHeaderProps) {\n  const info = statusMap[status] ?? { bg: 'bg-gray-100 text-gray-700', label: status };\n\n  return (\n    <div>\n      <Link\n        to=\"/contenedores\"\n        className=\"text-teal-600 hover:text-teal-700 text-sm font-medium mb-3 inline-flex items-center cursor-pointer\"\n      >\n        <i className=\"ri-arrow-left-line mr-1\"></i>\n        Volver a Contenedores\n      </Link>\n\n      <div className=\"bg-white rounded-xl border border-gray-100 p-4 md:p-5 mt-2\">\n        <div className=\"flex items-start justify-between gap-3 flex-wrap\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-10 h-10 md:w-12 md:h-12 bg-gradient-to-br from-rose-500 to-rose-600 rounded-lg flex items-center justify-center flex-shrink-0\">\n              <i className=\"ri-inbox-line text-xl md:text-2xl text-white\"></i>\n            </div>\n            <div>\n              <h2 className=\"text-lg md:text-xl font-bold text-gray-900 font-mono\">{code}</h2>\n              <div className=\"flex items-center gap-2 mt-0.5 flex-wrap\">\n                <span className=\"text-sm text-gray-600 font-medium\">{tienda}</span>\n                {camion && (\n                  <span className=\"inline-flex items-center gap-1 text-xs text-amber-600 font-medium\">\n                    <i className=\"ri-truck-line\"></i>\n                    {camion}\n                  </span>\n                )}\n              </div>\n            </div>\n          </div>\n          <span className={`px-3 py-1.5 rounded-full text-xs font-semibold ${info.bg}`}>\n            {info.label}\n          </span>\n        </div>\n\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 mt-4 pt-4 border-t border-gray-100\">\n          <div>\n            <p className=\"text-[10px] uppercase tracking-wider text-gray-400 font-medium\">Creado</p>\n            <p className=\"text-xs md:text-sm text-gray-800 mt-1\">{formatDate(createdAt)}</p>\n          </div>\n          {closedAt && (\n            <div>\n              <p className=\"text-[10px] uppercase tracking-wider text-gray-400 font-medium\">Cerrado</p>\n              <p className=\"text-xs md:text-sm text-gray-800 mt-1\">{formatDate(closedAt)}</p>\n            </div>\n          )}\n          {createdByEmail && (\n            <div>\n              <p className=\"text-[10px] uppercase tracking-wider text-gray-400 font-medium\">Creado por</p>\n              <p className=\"text-xs md:text-sm text-gray-800 mt-1\">{createdByEmail}</p>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","interface ContainerSummaryProps {\n  totalPallets: number;\n  totalSkus: number;\n  totalUnits: number;\n}\n\nexport default function ContainerSummary({ totalPallets, totalSkus, totalUnits }: ContainerSummaryProps) {\n  const cards = [\n    {\n      label: 'Pallets',\n      value: totalPallets,\n      icon: 'ri-stack-line',\n      gradient: 'from-teal-500 to-cyan-600',\n    },\n    {\n      label: 'SKUs distintos',\n      value: totalSkus,\n      icon: 'ri-barcode-line',\n      gradient: 'from-violet-500 to-purple-600',\n    },\n    {\n      label: 'Unidades totales',\n      value: totalUnits.toLocaleString('es-ES'),\n      icon: 'ri-hashtag',\n      gradient: 'from-rose-500 to-pink-600',\n    },\n  ];\n\n  return (\n    <div className=\"grid grid-cols-3 gap-3 md:gap-4\">\n      {cards.map((card) => (\n        <div key={card.label} className=\"bg-white rounded-xl border border-gray-100 p-3 md:p-5 flex flex-col md:flex-row items-center md:items-center gap-2 md:gap-4\">\n          <div className={`w-9 h-9 md:w-11 md:h-11 bg-gradient-to-br ${card.gradient} rounded-lg flex items-center justify-center flex-shrink-0`}>\n            <i className={`${card.icon} text-base md:text-xl text-white`}></i>\n          </div>\n          <div className=\"text-center md:text-left\">\n            <p className=\"text-xl md:text-2xl font-bold text-gray-900\">{card.value}</p>\n            <p className=\"text-[10px] md:text-xs text-gray-500 mt-0.5 leading-tight\">{card.label}</p>\n          </div>\n        </div>\n      ))}\n    </div>\n  );\n}\n","\nimport { useState } from 'react';\n\nexport interface ContainerContentRow {\n  id: string;\n  pallet_code: string;\n  ubicacion: string;\n  sku: string;\n  descripcion: string;\n  barcode: string;\n  qty: number;\n  camion?: string;\n}\n\ninterface Props {\n  rows: ContainerContentRow[];\n  containerStatus: string;\n  onReverse?: (lineId: string) => void;\n}\n\nexport default function ContainerContentTable({ rows, containerStatus, onReverse }: Props) {\n  const canReverse = containerStatus !== 'DISPATCHED';\n\n  if (rows.length === 0) {\n    return (\n      <div className=\"bg-white rounded-xl border border-gray-100 p-10 text-center\">\n        <div className=\"w-14 h-14 bg-gray-50 rounded-2xl flex items-center justify-center mx-auto mb-3\">\n          <i className=\"ri-inbox-line text-3xl text-gray-300\"></i>\n        </div>\n        <p className=\"text-sm text-gray-500\">No hay líneas en este contenedor</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-white rounded-xl border border-gray-100 overflow-hidden\">\n      <div className=\"px-4 py-3 md:px-6 md:py-4 border-b border-gray-100\">\n        <h3 className=\"text-base md:text-lg font-bold text-gray-900\">Contenido del Contenedor</h3>\n        <p className=\"text-xs text-gray-500 mt-0.5\">{rows.length} líneas registradas</p>\n      </div>\n\n      {/* Mobile card list */}\n      <div className=\"md:hidden divide-y divide-gray-100\">\n        {rows.map((row) => (\n          <div key={row.id} className=\"p-4 space-y-2\">\n            <div className=\"flex items-center justify-between gap-2\">\n              <div className=\"flex items-center gap-2 min-w-0\">\n                <div className=\"w-8 h-8 bg-gradient-to-br from-teal-500 to-cyan-600 rounded-lg flex items-center justify-center flex-shrink-0\">\n                  <i className=\"ri-stack-line text-white text-sm\"></i>\n                </div>\n                <span className=\"text-sm font-bold text-gray-900 font-mono truncate\">{row.pallet_code}</span>\n              </div>\n              <span className=\"text-xl font-bold text-teal-600 flex-shrink-0\">{row.qty}</span>\n            </div>\n\n            <div className=\"flex items-center gap-2 flex-wrap\">\n              <span className=\"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-semibold bg-sky-100 text-sky-700 font-mono\">\n                {row.sku}\n              </span>\n              {row.ubicacion && (\n                <span className=\"text-xs text-gray-500\">\n                  <i className=\"ri-map-pin-line mr-0.5\"></i>{row.ubicacion}\n                </span>\n              )}\n            </div>\n\n            {row.descripcion && (\n              <p className=\"text-xs text-gray-600 leading-snug\">{row.descripcion}</p>\n            )}\n\n            {row.barcode && (\n              <p className=\"text-xs text-gray-400 font-mono\">{row.barcode}</p>\n            )}\n\n            {canReverse && (\n              <button\n                onClick={() => onReverse?.(row.id)}\n                className=\"w-full mt-1 py-2.5 bg-amber-50 text-amber-700 rounded-lg text-xs font-semibold hover:bg-amber-100 active:bg-amber-200 transition-colors cursor-pointer flex items-center justify-center gap-1.5\"\n              >\n                <i className=\"ri-arrow-go-back-line\"></i>\n                Reversar línea\n              </button>\n            )}\n          </div>\n        ))}\n      </div>\n\n      {/* Desktop table */}\n      <div className=\"hidden md:block overflow-x-auto\">\n        <table className=\"w-full\">\n          <thead className=\"bg-gray-50 border-b border-gray-100\">\n            <tr>\n              <th className=\"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider\">Pallet</th>\n              <th className=\"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider\">Ubicación</th>\n              <th className=\"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider\">SKU</th>\n              <th className=\"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider\">Descripción</th>\n              <th className=\"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider\">Código de Barra</th>\n              <th className=\"px-6 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider\">Cantidad</th>\n              {canReverse && (\n                <th className=\"px-6 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider\">Acciones</th>\n              )}\n            </tr>\n          </thead>\n          <tbody className=\"divide-y divide-gray-100\">\n            {rows.map((row) => (\n              <tr key={row.id} className=\"hover:bg-gray-50 transition-colors\">\n                <td className=\"px-6 py-4 whitespace-nowrap\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"w-8 h-8 bg-gradient-to-br from-teal-500 to-cyan-600 rounded-lg flex items-center justify-center\">\n                      <i className=\"ri-stack-line text-white text-sm\"></i>\n                    </div>\n                    <span className=\"text-sm font-semibold text-gray-900 font-mono\">{row.pallet_code}</span>\n                  </div>\n                </td>\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{row.ubicacion || '—'}</td>\n                <td className=\"px-6 py-4 whitespace-nowrap\">\n                  <span className=\"inline-flex items-center px-2.5 py-1 rounded-md text-xs font-semibold bg-sky-100 text-sky-700 font-mono\">\n                    {row.sku}\n                  </span>\n                </td>\n                <td className=\"px-6 py-4 text-sm text-gray-700\">{row.descripcion || '—'}</td>\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-mono\">{row.barcode || '—'}</td>\n                <td className=\"px-6 py-4 whitespace-nowrap text-center\">\n                  <span className=\"text-sm font-bold text-teal-600\">{row.qty}</span>\n                </td>\n                {canReverse && (\n                  <td className=\"px-6 py-4 whitespace-nowrap text-center\">\n                    <button\n                      onClick={() => onReverse?.(row.id)}\n                      className=\"inline-flex items-center px-3 py-1.5 bg-amber-50 text-amber-700 rounded-lg text-xs font-semibold hover:bg-amber-100 transition-colors cursor-pointer gap-1.5\"\n                    >\n                      <i className=\"ri-arrow-go-back-line\"></i>\n                      Reversar\n                    </button>\n                  </td>\n                )}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n}\n","import { useState, useEffect } from 'react';\nimport { supabase } from '../../../../lib/supabase';\nimport { useToast } from '../../../../components/base/Toast';\nimport { useAuth } from '../../../../contexts/AuthContext';\n\ninterface LineDetails {\n  id: string;\n  container_id: string;\n  pallet_id: string;\n  sku: string;\n  qty: number;\n  source_import_line_id: string;\n  pallet_code: string;\n  descripcion: string;\n  tienda: string;\n}\n\ninterface Props {\n  lineId: string;\n  onClose: () => void;\n  onSuccess: () => void;\n}\n\nexport default function ReverseLineModal({ lineId, onClose, onSuccess }: Props) {\n  const { user } = useAuth();\n  const { showToast } = useToast();\n  const [loading, setLoading] = useState(false);\n  const [lineDetails, setLineDetails] = useState<LineDetails | null>(null);\n  const [error, setError] = useState('');\n\n  // Cargar detalles de la línea\n  useEffect(() => {\n    loadLineDetails();\n  }, [lineId]);\n\n  const loadLineDetails = async () => {\n    try {\n      const { data, error: fetchErr } = await supabase\n        .from('container_lines')\n        .select(`\n          id,\n          container_id,\n          pallet_id,\n          sku,\n          qty,\n          source_import_line_id,\n          pallets(pallet_code),\n          import_lines:source_import_line_id(descripcion, tienda)\n        `)\n        .eq('id', lineId)\n        .maybeSingle();\n\n      if (fetchErr) throw fetchErr;\n      if (!data) {\n        setError('Línea no encontrada');\n        return;\n      }\n\n      setLineDetails({\n        id: data.id,\n        container_id: data.container_id,\n        pallet_id: data.pallet_id,\n        sku: data.sku,\n        qty: data.qty,\n        source_import_line_id: data.source_import_line_id,\n        pallet_code: (data.pallets as any)?.pallet_code || '—',\n        descripcion: (data.import_lines as any)?.descripcion || '—',\n        tienda: (data.import_lines as any)?.tienda || '—',\n      });\n    } catch (err: any) {\n      console.error('Error cargando detalles de línea:', err);\n      setError('Error al cargar los detalles');\n    }\n  };\n\n  const handleReverse = async () => {\n    if (!lineDetails || !user) return;\n\n    setLoading(true);\n    setError('');\n\n    try {\n      // 1. Verificar que el contenedor NO esté DISPATCHED\n      const { data: container } = await supabase\n        .from('containers')\n        .select('status')\n        .eq('id', lineDetails.container_id)\n        .maybeSingle();\n\n      if (!container) {\n        throw new Error('Contenedor no encontrado');\n      }\n\n      if (container.status === 'DISPATCHED') {\n        throw new Error('No se pueden reversar líneas de contenedores despachados');\n      }\n\n      // 2. Devolver cantidad al inventario del pallet\n      const { data: currentInv } = await supabase\n        .from('pallet_inventory')\n        .select('qty_available')\n        .eq('pallet_id', lineDetails.pallet_id)\n        .eq('sku', lineDetails.sku)\n        .maybeSingle();\n\n      if (!currentInv) {\n        throw new Error('Inventario del pallet no encontrado');\n      }\n\n      const { error: invError } = await supabase\n        .from('pallet_inventory')\n        .update({ qty_available: currentInv.qty_available + lineDetails.qty })\n        .eq('pallet_id', lineDetails.pallet_id)\n        .eq('sku', lineDetails.sku);\n\n      if (invError) throw invError;\n\n      // 3. Restar cantidad confirmada de la línea de importación\n      const { data: importLine } = await supabase\n        .from('import_lines')\n        .select('qty_confirmed, qty_to_send')\n        .eq('id', lineDetails.source_import_line_id)\n        .maybeSingle();\n\n      if (!importLine) {\n        throw new Error('Línea de importación no encontrada');\n      }\n\n      const newConfirmed = Math.max(0, importLine.qty_confirmed - lineDetails.qty);\n      const newStatus = newConfirmed === 0 ? 'PENDING' : newConfirmed >= importLine.qty_to_send ? 'DONE' : 'PARTIAL';\n\n      const { error: lineError } = await supabase\n        .from('import_lines')\n        .update({\n          qty_confirmed: newConfirmed,\n          status: newStatus,\n          ...(newStatus !== 'DONE' ? { done_at: null, done_by: null } : {}),\n        })\n        .eq('id', lineDetails.source_import_line_id);\n\n      if (lineError) throw lineError;\n\n      // 4. Eliminar la línea del contenedor\n      const { error: deleteError } = await supabase\n        .from('container_lines')\n        .delete()\n        .eq('id', lineDetails.id);\n\n      if (deleteError) throw deleteError;\n\n      // 5. Registrar evento de reversión\n      await supabase.from('scan_events').insert({\n        pallet_id: lineDetails.pallet_id,\n        event_type: 'REVERSE',\n        sku: lineDetails.sku,\n        tienda: lineDetails.tienda,\n        qty: lineDetails.qty,\n        user_id: user.id,\n        notes: `Reversión de línea de contenedor`,\n      });\n\n      showToast(\n        'success',\n        'Línea reversada',\n        `${lineDetails.qty} uds de ${lineDetails.sku} devueltas al pallet ${lineDetails.pallet_code}`\n      );\n\n      onSuccess();\n      onClose();\n    } catch (err: any) {\n      console.error('Error reversando línea:', err);\n      setError(err.message || 'Error al reversar la línea');\n      showToast('error', 'Error', err.message || 'No se pudo reversar la línea');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!lineDetails) {\n    return (\n      <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n        <div className=\"bg-white rounded-xl shadow-xl max-w-md w-full p-6\">\n          <div className=\"flex items-center justify-center py-8\">\n            <div className=\"animate-spin rounded-full h-10 w-10 border-b-2 border-teal-500\"></div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white rounded-xl shadow-xl max-w-md w-full\">\n        <div className=\"p-6 border-b border-gray-200\">\n          <div className=\"flex items-center justify-between\">\n            <h3 className=\"text-xl font-bold text-gray-900\">Reversar Línea</h3>\n            <button\n              onClick={onClose}\n              disabled={loading}\n              className=\"text-gray-400 hover:text-gray-600 cursor-pointer\"\n            >\n              <i className=\"ri-close-line text-2xl\"></i>\n            </button>\n          </div>\n        </div>\n\n        <div className=\"p-6\">\n          <div className=\"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6\">\n            <div className=\"flex items-start\">\n              <i className=\"ri-alert-line text-amber-600 text-xl mr-3 mt-0.5\"></i>\n              <div>\n                <p className=\"text-sm font-medium text-amber-900 mb-1\">Confirmar reversión</p>\n                <p className=\"text-sm text-amber-700\">\n                  Esta acción devolverá la cantidad al pallet de origen y actualizará el estado del pedido.\n                </p>\n              </div>\n            </div>\n          </div>\n\n          {error && (\n            <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm mb-6\">\n              {error}\n            </div>\n          )}\n\n          <div className=\"space-y-4 mb-6\">\n            <div className=\"flex items-center justify-between py-2 border-b border-gray-100\">\n              <span className=\"text-sm font-medium text-gray-700\">Pallet:</span>\n              <span className=\"text-sm font-semibold text-gray-900\">{lineDetails.pallet_code}</span>\n            </div>\n            <div className=\"flex items-center justify-between py-2 border-b border-gray-100\">\n              <span className=\"text-sm font-medium text-gray-700\">SKU:</span>\n              <span className=\"text-sm font-semibold text-gray-900\">{lineDetails.sku}</span>\n            </div>\n            <div className=\"flex items-center justify-between py-2 border-b border-gray-100\">\n              <span className=\"text-sm font-medium text-gray-700\">Descripción:</span>\n              <span className=\"text-sm text-gray-900\">{lineDetails.descripcion}</span>\n            </div>\n            <div className=\"flex items-center justify-between py-2 border-b border-gray-100\">\n              <span className=\"text-sm font-medium text-gray-700\">Tienda:</span>\n              <span className=\"text-sm font-semibold text-gray-900\">{lineDetails.tienda}</span>\n            </div>\n            <div className=\"flex items-center justify-between py-2\">\n              <span className=\"text-sm font-medium text-gray-700\">Cantidad a reversar:</span>\n              <span className=\"text-lg font-bold text-amber-600\">{lineDetails.qty} uds</span>\n            </div>\n          </div>\n\n          <div className=\"flex items-center space-x-4\">\n            <button\n              onClick={onClose}\n              disabled={loading}\n              className=\"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors whitespace-nowrap cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              Cancelar\n            </button>\n            <button\n              onClick={handleReverse}\n              disabled={loading}\n              className=\"flex-1 px-6 py-3 bg-gradient-to-r from-amber-500 to-amber-600 text-white rounded-lg font-medium hover:from-amber-600 hover:to-amber-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap cursor-pointer\"\n            >\n              {loading ? (\n                <>\n                  <i className=\"ri-loader-4-line mr-2 animate-spin\"></i>\n                  Reversando...\n                </>\n              ) : (\n                <>\n                  <i className=\"ri-arrow-go-back-line mr-2\"></i>\n                  Confirmar Reversión\n                </>\n              )}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","\nimport { useEffect, useState, useMemo } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { supabase } from '../../../lib/supabase';\nimport ContainerHeader from './components/ContainerHeader';\nimport ContainerSummary from './components/ContainerSummary';\nimport ContainerContentTable, { ContainerContentRow } from './components/ContainerContentTable';\nimport ReverseLineModal from './components/ReverseLineModal';\n\ninterface ContainerData {\n  id: string;\n  code: string;\n  tienda: string;\n  status: string;\n  created_at: string;\n  closed_at: string | null;\n  created_by: string;\n}\n\ninterface RawContainerLine {\n  id: string;\n  qty: number;\n  sku: string;\n  pallet_id: string | null;\n  pallets: { id: string; pallet_code: string; ubicacion: string } | null;\n  import_lines: {\n    id: string;\n    descripcion: string;\n    barcode: string;\n    tienda: string;\n    camion: string;\n  } | null;\n}\n\nexport default function ContenedorDetallePage() {\n  const { id } = useParams<{ id: string }>();\n  const [container, setContainer] = useState<ContainerData | null>(null);\n  const [lines, setLines] = useState<RawContainerLine[]>([]);\n  const [createdByEmail, setCreatedByEmail] = useState('');\n  const [camion, setCamion] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [reverseLineId, setReverseLineId] = useState<string | null>(null);\n\n  // Load container data when the id changes\n  useEffect(() => {\n    if (!id) return;\n    loadContainer();\n  }, [id]);\n\n  /** Fetch container and its related data */\n  const loadContainer = async () => {\n    setLoading(true);\n    setError('');\n    try {\n      const { data, error: fetchErr } = await supabase\n        .from('containers')\n        .select(\n          `\n            id, code, tienda, status, created_at, closed_at, created_by,\n            container_lines(\n              id, qty, sku, pallet_id,\n              pallets(id, pallet_code, ubicacion),\n              import_lines:source_import_line_id(id, descripcion, barcode, tienda, camion)\n            )\n          `\n        )\n        .eq('id', id)\n        .maybeSingle();\n\n      if (fetchErr) throw fetchErr;\n      if (!data) {\n        setError('Contenedor no encontrado');\n        return;\n      }\n\n      // Set container meta‑data\n      setContainer({\n        id: data.id,\n        code: data.code,\n        tienda: data.tienda,\n        status: data.status,\n        created_at: data.created_at,\n        closed_at: data.closed_at,\n        created_by: data.created_by,\n      });\n\n      // Set lines\n      const containerLines = (data.container_lines as RawContainerLine[]) ?? [];\n      setLines(containerLines);\n\n      // Extract truck (camión) info from the first line, if available\n      if (containerLines.length > 0 && containerLines[0].import_lines?.camion) {\n        setCamion(containerLines[0].import_lines.camion);\n      }\n\n      // Fetch creator’s email / full name\n      if (data.created_by) {\n        const { data: userData, error: userErr } = await supabase\n          .from('users')\n          .select('email, full_name')\n          .eq('auth_id', data.created_by)\n          .maybeSingle();\n\n        if (userErr) throw userErr;\n        if (userData) {\n          setCreatedByEmail(userData.full_name || userData.email);\n        }\n      }\n    } catch (err: any) {\n      console.error('Error cargando contenedor:', err);\n      setError('Error al cargar el contenedor');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  /** Open the reverse‑line modal */\n  const handleReverseClick = (lineId: string) => {\n    setReverseLineId(lineId);\n  };\n\n  /** Refresh data after a successful reversal */\n  const handleReverseSuccess = () => {\n    loadContainer();\n  };\n\n  /** Build rows for the table: group by pallet_code + sku and sum quantities */\n  const tableRows: ContainerContentRow[] = useMemo(() => {\n    const grouped = new Map<string, ContainerContentRow>();\n\n    lines.forEach((line) => {\n      const palletCode = line.pallets?.pallet_code ?? '—';\n      const key = `${palletCode}|${line.sku}`;\n\n      if (grouped.has(key)) {\n        const existing = grouped.get(key)!;\n        existing.qty += Number(line.qty) || 0;\n      } else {\n        grouped.set(key, {\n          id: line.id,\n          pallet_code: palletCode,\n          ubicacion: line.pallets?.ubicacion ?? '',\n          sku: line.sku,\n          descripcion: line.import_lines?.descripcion ?? '',\n          barcode: line.import_lines?.barcode ?? '',\n          qty: Number(line.qty) || 0,\n        });\n      }\n    });\n\n    return Array.from(grouped.values());\n  }, [lines]);\n\n  /** KPI: distinct pallets */\n  const totalPallets = useMemo(() => {\n    const uniquePalletIds = new Set<string>();\n    lines.forEach((l) => {\n      if (l.pallet_id) uniquePalletIds.add(l.pallet_id);\n    });\n    return uniquePalletIds.size;\n  }, [lines]);\n\n  /** KPI: distinct SKUs */\n  const totalSkus = useMemo(() => {\n    const uniqueSkus = new Set<string>();\n    lines.forEach((l) => {\n      if (l.sku) uniqueSkus.add(l.sku);\n    });\n    return uniqueSkus.size;\n  }, [lines]);\n\n  /** KPI: total units */\n  const totalUnits = useMemo(() => {\n    return lines.reduce((sum, l) => sum + (Number(l.qty) || 0), 0);\n  }, [lines]);\n\n  // ----- Render ---------------------------------------------------------\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-20\">\n        <div className=\"animate-spin rounded-full h-10 w-10 border-b-2 border-teal-500\"></div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"text-center py-20\">\n        <div className=\"w-16 h-16 bg-red-50 rounded-2xl flex items-center justify-center mx-auto mb-4\">\n          <i className=\"ri-error-warning-line text-3xl text-red-400\"></i>\n        </div>\n        <p className=\"text-sm text-gray-600\">{error}</p>\n      </div>\n    );\n  }\n\n  if (!container) return null;\n\n  return (\n    <div className=\"space-y-6\">\n      <ContainerHeader\n        code={container.code}\n        tienda={container.tienda}\n        camion={camion}\n        status={container.status}\n        createdAt={container.created_at}\n        closedAt={container.closed_at}\n        createdByEmail={createdByEmail}\n      />\n\n      <ContainerSummary totalPallets={totalPallets} totalSkus={totalSkus} totalUnits={totalUnits} />\n\n      <ContainerContentTable rows={tableRows} containerStatus={container.status} onReverse={handleReverseClick} />\n\n      {reverseLineId && (\n        <ReverseLineModal\n          lineId={reverseLineId}\n          onClose={() => setReverseLineId(null)}\n          onSuccess={handleReverseSuccess}\n        />\n      )}\n    </div>\n  );\n}\n"],"names":["statusMap","formatDate","dateStr","date","ContainerHeader","code","tienda","camion","status","createdAt","closedAt","createdByEmail","info","jsxs","Link","jsx","ContainerSummary","totalPallets","totalSkus","totalUnits","cards","card","ContainerContentTable","rows","containerStatus","onReverse","canReverse","row","ReverseLineModal","lineId","onClose","onSuccess","user","useAuth","showToast","useToast","loading","setLoading","useState","lineDetails","setLineDetails","error","setError","useEffect","loadLineDetails","data","fetchErr","supabase","err","handleReverse","container","currentInv","invError","importLine","newConfirmed","newStatus","lineError","deleteError","Fragment","ContenedorDetallePage","id","useParams","setContainer","lines","setLines","setCreatedByEmail","setCamion","reverseLineId","setReverseLineId","loadContainer","containerLines","userData","userErr","handleReverseClick","handleReverseSuccess","tableRows","useMemo","grouped","line","palletCode","key","existing","uniquePalletIds","uniqueSkus","sum"],"mappings":"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"}