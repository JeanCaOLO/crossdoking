{"version":3,"file":"page-8DqwElIY.js","sources":["../../src/pages/reportes/components/MovimientosFilters.tsx","../../src/pages/reportes/components/MovimientosStats.tsx","../../src/pages/reportes/components/MovimientosTable.tsx","../../src/pages/reportes/page.tsx"],"sourcesContent":["\nimport { useState } from 'react';\n\ninterface FiltersProps {\n  imports: { id: string; file_name: string }[];\n  onFilterChange: (filters: FilterValues) => void;\n}\n\nexport interface FilterValues {\n  importId: string;\n  eventType: string;\n  dateFrom: string;\n  dateTo: string;\n  searchTerm: string;\n}\n\nconst eventTypes = [\n  { value: 'all', label: 'Todos los tipos' },\n  { value: 'SCAN_PALLET', label: 'Escaneo Pallet' },\n  { value: 'SCAN_SKU', label: 'Escaneo SKU' },\n  { value: 'CONFIRM_QTY', label: 'Confirmación' },\n  { value: 'REVERSE', label: 'Reversión' },\n  { value: 'CLOSE', label: 'Cierre' },\n  { value: 'UNLOCK', label: 'Desbloqueo' },\n  { value: 'ADJUST', label: 'Ajuste' },\n];\n\nexport default function MovimientosFilters({ imports, onFilterChange }: FiltersProps) {\n  const [filters, setFilters] = useState<FilterValues>({\n    importId: 'all',\n    eventType: 'all',\n    dateFrom: '',\n    dateTo: '',\n    searchTerm: '',\n  });\n\n  const updateFilter = (key: keyof FilterValues, value: string) => {\n    const newFilters = { ...filters, [key]: value };\n    setFilters(newFilters);\n    onFilterChange(newFilters);\n  };\n\n  const clearFilters = () => {\n    const cleared: FilterValues = {\n      importId: 'all',\n      eventType: 'all',\n      dateFrom: '',\n      dateTo: '',\n      searchTerm: '',\n    };\n    setFilters(cleared);\n    onFilterChange(cleared);\n  };\n\n  const hasActiveFilters =\n    filters.importId !== 'all' ||\n    filters.eventType !== 'all' ||\n    filters.dateFrom !== '' ||\n    filters.dateTo !== '' ||\n    filters.searchTerm !== '';\n\n  return (\n    <div className=\"bg-white rounded-xl border border-gray-100 p-5\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-sm font-semibold text-gray-900\">Filtros</h3>\n        {hasActiveFilters && (\n          <button\n            onClick={clearFilters}\n            className=\"text-xs text-teal-600 hover:text-teal-700 font-medium cursor-pointer whitespace-nowrap\"\n          >\n            <i className=\"ri-filter-off-line mr-1\"></i>\n            Limpiar filtros\n          </button>\n        )}\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-3\">\n        <div>\n          <label className=\"block text-xs font-medium text-gray-500 mb-1.5\">Buscar</label>\n          <div className=\"relative\">\n            <i className=\"ri-search-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm\"></i>\n            <input\n              type=\"text\"\n              value={filters.searchTerm}\n              onChange={(e) => updateFilter('searchTerm', e.target.value)}\n              placeholder=\"SKU, tienda, notas...\"\n              className=\"w-full pl-9 pr-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-teal-500 focus:border-transparent\"\n            />\n          </div>\n        </div>\n\n        <div>\n          <label className=\"block text-xs font-medium text-gray-500 mb-1.5\">Tipo de Evento</label>\n          <select\n            value={filters.eventType}\n            onChange={(e) => updateFilter('eventType', e.target.value)}\n            className=\"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-teal-500 focus:border-transparent cursor-pointer\"\n          >\n            {eventTypes.map((t) => (\n              <option key={t.value} value={t.value}>\n                {t.label}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        <div>\n          <label className=\"block text-xs font-medium text-gray-500 mb-1.5\">Importación</label>\n          <select\n            value={filters.importId}\n            onChange={(e) => updateFilter('importId', e.target.value)}\n            className=\"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-teal-500 focus:border-transparent cursor-pointer\"\n          >\n            <option value=\"all\">Todas</option>\n            {imports.map((imp) => (\n              <option key={imp.id} value={imp.id}>\n                {imp.file_name}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        <div>\n          <label className=\"block text-xs font-medium text-gray-500 mb-1.5\">Desde</label>\n          <input\n            type=\"date\"\n            value={filters.dateFrom}\n            onChange={(e) => updateFilter('dateFrom', e.target.value)}\n            className=\"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-teal-500 focus:border-transparent cursor-pointer\"\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-xs font-medium text-gray-500 mb-1.5\">Hasta</label>\n          <input\n            type=\"date\"\n            value={filters.dateTo}\n            onChange={(e) => updateFilter('dateTo', e.target.value)}\n            className=\"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-teal-5\n\n            focus:border-transparent cursor-pointer\"\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n","\nimport React from 'react';\n\ninterface StatsProps {\n  totalMovimientos: number;\n  totalConfirmaciones: number;\n  totalReversiones: number;\n  totalUnidades: number;\n}\n\n/**\n * MovimientosStats component displays a set of statistical cards.\n * It safely handles missing or malformed numeric values by falling back\n * to zero and wrapping number formatting in a try/catch block.\n */\nexport default function MovimientosStats({\n  totalMovimientos,\n  totalConfirmaciones,\n  totalReversiones,\n  totalUnidades,\n}: StatsProps) {\n  // Guard against undefined / NaN values\n  const safeNumber = (value: unknown): number => {\n    const num = Number(value);\n    return Number.isFinite(num) ? num : 0;\n  };\n\n  const stats = [\n    {\n      label: 'Total Movimientos',\n      value: safeNumber(totalMovimientos),\n      icon: 'ri-exchange-line',\n      gradient: 'from-teal-50 to-cyan-50',\n      border: 'border-teal-200',\n      iconBg: 'bg-teal-100',\n      iconColor: 'text-teal-600',\n      valueColor: 'text-teal-700',\n    },\n    {\n      label: 'Confirmaciones',\n      value: safeNumber(totalConfirmaciones),\n      icon: 'ri-checkbox-circle-line',\n      gradient: 'from-emerald-50 to-green-50',\n      border: 'border-emerald-200',\n      iconBg: 'bg-emerald-100',\n      iconColor: 'text-emerald-600',\n      valueColor: 'text-emerald-700',\n    },\n    {\n      label: 'Reversiones',\n      value: safeNumber(totalReversiones),\n      icon: 'ri-arrow-go-back-line',\n      gradient: 'from-amber-50 to-orange-50',\n      border: 'border-amber-200',\n      iconBg: 'bg-amber-100',\n      iconColor: 'text-amber-600',\n      valueColor: 'text-amber-700',\n    },\n    {\n      label: 'Unidades Movidas',\n      value: safeNumber(totalUnidades),\n      icon: 'ri-stack-line',\n      gradient: 'from-rose-50 to-pink-50',\n      border: 'border-rose-200',\n      iconBg: 'bg-rose-100',\n      iconColor: 'text-rose-600',\n      valueColor: 'text-rose-700',\n    },\n  ];\n\n  const formatNumber = (num: number) => {\n    try {\n      return num.toLocaleString();\n    } catch {\n      // Fallback for environments where toLocaleString might fail\n      return String(num);\n    }\n  };\n\n  return (\n    <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4\">\n      {stats.map((stat) => (\n        <div\n          key={stat.label}\n          className={`bg-gradient-to-br ${stat.gradient} border ${stat.border} rounded-xl p-4`}\n        >\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-xs font-medium text-gray-600\">{stat.label}</p>\n              <p className={`text-2xl font-bold ${stat.valueColor} mt-1`}>\n                {formatNumber(stat.value)}\n              </p>\n            </div>\n            <div className={`w-11 h-11 ${stat.iconBg} rounded-lg flex items-center justify-center`}>\n              <i className={`${stat.icon} text-xl ${stat.iconColor}`} />\n            </div>\n          </div>\n        </div>\n      ))}\n    </div>\n  );\n}\n","import React from 'react';\n\ninterface ScanEventRow {\n  id: string;\n  event_type: string;\n  sku: string | null;\n  tienda: string | null;\n  camion: string | null;\n  qty: number | null;\n  notes: string | null;\n  created_at: string;\n  pallet_code: string;\n  user_name: string;\n}\n\ninterface Props {\n  rows: ScanEventRow[];\n  loading: boolean;\n  page: number;\n  totalPages: number;\n  onPageChange: (page: number) => void;\n}\n\nconst eventTypeConfig: Record<\n  string,\n  { label: string; bg: string; icon: string }\n> = {\n  SCAN_PALLET: {\n    label: 'Escaneo Pallet',\n    bg: 'bg-sky-100 text-sky-700',\n    icon: 'ri-qr-scan-2-line',\n  },\n  SCAN_SKU: {\n    label: 'Escaneo SKU',\n    bg: 'bg-indigo-100 text-indigo-700',\n    icon: 'ri-barcode-line',\n  },\n  CONFIRM_QTY: {\n    label: 'Confirmación',\n    bg: 'bg-emerald-100 text-emerald-700',\n    icon: 'ri-checkbox-circle-line',\n  },\n  REVERSE: {\n    label: 'Reversión',\n    bg: 'bg-amber-100 text-amber-700',\n    icon: 'ri-arrow-go-back-line',\n  },\n  CLOSE: {\n    label: 'Cierre',\n    bg: 'bg-rose-100 text-rose-700',\n    icon: 'ri-lock-line',\n  },\n  UNLOCK: {\n    label: 'Desbloqueo',\n    bg: 'bg-cyan-100 text-cyan-700',\n    icon: 'ri-lock-unlock-line',\n  },\n  ADJUST: {\n    label: 'Ajuste',\n    bg: 'bg-orange-100 text-orange-700',\n    icon: 'ri-settings-3-line',\n  },\n};\n\nfunction formatDateTime(dateStr: string) {\n  return new Date(dateStr).toLocaleDateString('es-ES', {\n    day: '2-digit',\n    month: 'short',\n    year: 'numeric',\n    hour: '2-digit',\n    minute: '2-digit',\n    second: '2-digit',\n  });\n}\n\nexport type { ScanEventRow };\n\nexport default function MovimientosTable({\n  rows,\n  loading,\n  page,\n  totalPages,\n  onPageChange,\n}: Props) {\n  // Guard against invalid pagination values\n  const safePage = Math.max(1, Math.min(page, totalPages));\n\n  if (loading) {\n    return (\n      <div className=\"bg-white rounded-xl border border-gray-100 p-12\">\n        <div className=\"flex items-center justify-center\">\n          <div className=\"animate-spin rounded-full h-10 w-10 border-b-2 border-teal-500\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (rows.length === 0) {\n    return (\n      <div className=\"bg-white rounded-xl border border-gray-100 p-12 text-center\">\n        <div className=\"w-16 h-16 bg-gray-50 rounded-2xl flex items-center justify-center mx-auto mb-4\">\n          <i className=\"ri-file-list-3-line text-3xl text-gray-300\"></i>\n        </div>\n        <p className=\"text-sm text-gray-600 font-medium\">\n          No se encontraron movimientos\n        </p>\n        <p className=\"text-xs text-gray-400 mt-1\">\n          Ajusta los filtros para ver resultados\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-white rounded-xl border border-gray-100 overflow-hidden\">\n      <div className=\"px-5 py-4 border-b border-gray-100 flex items-center justify-between\">\n        <div>\n          <h3 className=\"text-sm font-bold text-gray-900\">\n            Historial de Movimientos\n          </h3>\n          <p className=\"text-xs text-gray-500 mt-0.5\">\n            Página {safePage} de {totalPages}\n          </p>\n        </div>\n      </div>\n\n      <div className=\"overflow-x-auto\">\n        <table className=\"w-full\">\n          <thead className=\"bg-gray-50 border-b border-gray-200\">\n            <tr>\n              <th className=\"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider\">\n                Fecha / Hora\n              </th>\n              <th className=\"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider\">\n                Tipo\n              </th>\n              <th className=\"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider\">\n                Pallet\n              </th>\n              <th className=\"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider\">\n                SKU\n              </th>\n              <th className=\"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider\">\n                Tienda\n              </th>\n              <th className=\"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider\">\n                Camión\n              </th>\n              <th className=\"px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider\">\n                Cantidad\n              </th>\n              <th className=\"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider\">\n                Usuario\n              </th>\n              <th className=\"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider\">\n                Notas\n              </th>\n            </tr>\n          </thead>\n          <tbody className=\"divide-y divide-gray-100\">\n            {rows.map((row) => {\n              const config =\n                eventTypeConfig[row.event_type] || {\n                  label: row.event_type,\n                  bg: 'bg-gray-100 text-gray-700',\n                  icon: 'ri-question-line',\n                };\n\n              return (\n                <tr\n                  key={row.id}\n                  className=\"hover:bg-gray-50/50 transition-colors\"\n                >\n                  <td className=\"px-4 py-3 whitespace-nowrap text-xs text-gray-600\">\n                    {formatDateTime(row.created_at)}\n                  </td>\n                  <td className=\"px-4 py-3 whitespace-nowrap\">\n                    <span\n                      className={`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${config.bg}`}\n                    >\n                      <i className={`${config.icon} mr-1.5`}></i>\n                      {config.label}\n                    </span>\n                  </td>\n                  <td className=\"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900\">\n                    {row.pallet_code || '\\u2014'}\n                  </td>\n                  <td className=\"px-4 py-3 whitespace-nowrap\">\n                    {row.sku ? (\n                      <span className=\"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium bg-sky-50 text-sky-700\">\n                        {row.sku}\n                      </span>\n                    ) : (\n                      <span className=\"text-xs text-gray-400\">\\u2014</span>\n                    )}\n                  </td>\n                  <td className=\"px-4 py-3 whitespace-nowrap text-sm text-gray-700\">\n                    {row.tienda || '\\u2014'}\n                  </td>\n                  <td className=\"px-4 py-3 whitespace-nowrap text-sm text-gray-700\">\n                    {row.camion ? (\n                      <span className=\"inline-flex items-center text-xs font-medium text-amber-700\">\n                        <i className=\"ri-truck-line mr-1\"></i>\n                        {row.camion}\n                      </span>\n                    ) : (\n                      <span className=\"text-xs text-gray-400\">\\u2014</span>\n                    )}\n                  </td>\n                  <td className=\"px-4 py-3 whitespace-nowrap text-center\">\n                    {row.qty !== null && row.qty !== undefined ? (\n                      <span\n                        className={`text-sm font-semibold ${\n                          row.event_type === 'REVERSE'\n                            ? 'text-amber-600'\n                            : 'text-teal-600'\n                        }`}\n                      >\n                        {row.event_type === 'REVERSE' ? '-' : '+'}\n                        {row.qty}\n                      </span>\n                    ) : (\n                      <span className=\"text-xs text-gray-400\">\\u2014</span>\n                    )}\n                  </td>\n                  <td className=\"px-4 py-3 whitespace-nowrap text-xs text-gray-600\">\n                    {row.user_name || '\\u2014'}\n                  </td>\n                  <td className=\"px-4 py-3 text-xs text-gray-500 max-w-[200px] truncate\">\n                    {row.notes || '\\u2014'}\n                  </td>\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n\n      {totalPages > 1 && (\n        <div className=\"px-5 py-3 border-t border-gray-100 flex items-center justify-between\">\n          <button\n            onClick={() => onPageChange(safePage - 1)}\n            disabled={safePage <= 1}\n            className=\"px-3 py-1.5 text-sm font-medium text-gray-600 bg-gray-50 rounded-lg hover:bg-gray-100 disabled:opacity-40 disabled:cursor-not-allowed transition-colors cursor-pointer whitespace-nowrap\"\n          >\n            <i className=\"ri-arrow-left-s-line mr-1\"></i>\n            Anterior\n          </button>\n\n          <div className=\"flex items-center space-x-1\">\n            {Array.from({ length: Math.min(totalPages, 7) }, (_, i) => {\n              let pageNum: number;\n              if (totalPages <= 7) {\n                pageNum = i + 1;\n              } else if (safePage <= 4) {\n                pageNum = i + 1;\n              } else if (safePage >= totalPages - 3) {\n                pageNum = totalPages - 6 + i;\n              } else {\n                pageNum = safePage - 3 + i;\n              }\n\n              return (\n                <button\n                  key={pageNum}\n                  onClick={() => onPageChange(pageNum)}\n                  className={`w-8 h-8 rounded-lg text-xs font-medium transition-colors cursor-pointer ${\n                    pageNum === safePage\n                      ? 'bg-teal-600 text-white'\n                      : 'text-gray-600 hover:bg-gray-100'\n                  }`}\n                >\n                  {pageNum}\n                </button>\n              );\n            })}\n          </div>\n\n          <button\n            onClick={() => onPageChange(safePage + 1)}\n            disabled={safePage >= totalPages}\n            className=\"px-3 py-1.5 text-sm font-medium text-gray-600 bg-gray-50 rounded-lg hover:bg-gray-100 disabled:opacity-40 disabled:cursor-not-allowed transition-colors cursor-pointer whitespace-nowrap\"\n          >\n            Siguiente\n            <i className=\"ri-arrow-right-s-line ml-1\"></i>\n          </button>\n        </div>\n      )}\n    </div>\n  );\n}\n","\nimport { useState, useEffect, useCallback } from 'react';\nimport { supabase } from '../../lib/supabase';\nimport { useToast } from '../../components/base/Toast';\nimport MovimientosFilters, { FilterValues } from './components/MovimientosFilters';\nimport MovimientosStats from './components/MovimientosStats';\nimport MovimientosTable, { ScanEventRow } from './components/MovimientosTable';\n\nconst PAGE_SIZE = 25;\n\nexport default function ReportesMovimientosPage() {\n  const { showToast } = useToast();\n  const [imports, setImports] = useState<{ id: string; file_name: string }[]>([]);\n  const [rows, setRows] = useState<ScanEventRow[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [page, setPage] = useState(1);\n  const [totalCount, setTotalCount] = useState(0);\n  const [filters, setFilters] = useState<FilterValues>({\n    importId: 'all',\n    eventType: 'all',\n    dateFrom: '',\n    dateTo: '',\n    searchTerm: '',\n  });\n\n  // Stats\n  const [stats, setStats] = useState({\n    total: 0,\n    confirmaciones: 0,\n    reversiones: 0,\n    unidades: 0,\n  });\n\n  /* -------------------------------------------------------------------------- */\n  /*                                   Effects                                 */\n  /* -------------------------------------------------------------------------- */\n  useEffect(() => {\n    loadImports();\n  }, []);\n\n  useEffect(() => {\n    loadMovimientos();\n    loadStats();\n  }, [page, filters]);\n\n  /* -------------------------------------------------------------------------- */\n  /*                               Data Loaders                                 */\n  /* -------------------------------------------------------------------------- */\n  const loadImports = async () => {\n    try {\n      const { data } = await supabase\n        .from('imports')\n        .select('id, file_name')\n        .order('created_at', { ascending: false });\n      setImports(data || []);\n    } catch (err) {\n      console.error('Error cargando imports:', err);\n    }\n  };\n\n  const buildBaseQuery = useCallback(\n    (selectStr: string, forCount = false) => {\n      let query = supabase\n        .from('scan_events')\n        .select(\n          selectStr,\n          forCount ? { count: 'exact', head: true } : undefined\n        );\n\n      if (filters.eventType !== 'all') {\n        query = query.eq('event_type', filters.eventType);\n      }\n\n      if (filters.dateFrom) {\n        query = query.gte('created_at', `${filters.dateFrom}T00:00:00`);\n      }\n\n      if (filters.dateTo) {\n        query = query.lte('created_at', `${filters.dateTo}T23:59:59`);\n      }\n\n      if (filters.searchTerm) {\n        const term = filters.searchTerm.trim();\n        query = query.or(\n          `sku.ilike.%${term}%,tienda.ilike.%${term}%,notes.ilike.%${term}%,raw_code.ilike.%${term}%`\n        );\n      }\n\n      return query;\n    },\n    [filters]\n  );\n\n  const loadStats = async () => {\n    try {\n      // Total\n      const totalQuery = buildBaseQuery('id', true);\n      const { count: totalAll } = await totalQuery;\n\n      // Confirmaciones\n      const confQuery = buildBaseQuery('id', true).eq(\n        'event_type',\n        'CONFIRM_QTY'\n      );\n      const { count: totalConf } = await confQuery;\n\n      // Reversiones\n      const revQuery = buildBaseQuery('id', true).eq('event_type', 'REVERSE');\n      const { count: totalRev } = await revQuery;\n\n      // Unidades: sum qty de CONFIRM_QTY y REVERSE\n      const { data: qtyData } = await buildBaseQuery('qty').in(\n        'event_type',\n        ['CONFIRM_QTY', 'REVERSE']\n      );\n      const totalUnidades = (qtyData || []).reduce(\n        (sum: number, r: any) => sum + (Number(r.qty) || 0),\n        0\n      );\n\n      setStats({\n        total: totalAll || 0,\n        confirmaciones: totalConf || 0,\n        reversiones: totalRev || 0,\n        unidades: totalUnidades,\n      });\n    } catch (err) {\n      console.error('Error cargando stats:', err);\n    }\n  };\n\n  const loadMovimientos = async () => {\n    setLoading(true);\n    try {\n      // Count\n      const countQuery = buildBaseQuery('id', true);\n      const { count } = await countQuery;\n      setTotalCount(count || 0);\n\n      // Data\n      const from = (page - 1) * PAGE_SIZE;\n      const to = from + PAGE_SIZE - 1;\n\n      const { data, error } = await buildBaseQuery(\n        'id, pallet_id, event_type, raw_code, sku, tienda, qty, notes, user_id, created_at, pallets(pallet_code), users:user_id(full_name, email)'\n      )\n        .order('created_at', { ascending: false })\n        .range(from, to);\n\n      if (error) throw error;\n\n      const mapped: ScanEventRow[] = (data || []).map((row: any) => ({\n        id: row.id,\n        event_type: row.event_type,\n        sku: row.sku,\n        tienda: row.tienda,\n        qty: row.qty,\n        notes: row.notes,\n        created_at: row.created_at,\n        pallet_code: row.pallets?.pallet_code || '',\n        user_name: row.users?.full_name || row.users?.email || '',\n      }));\n\n      setRows(mapped);\n    } catch (err: any) {\n      console.error('Error cargando movimientos:', err);\n      showToast('error', 'Error', 'No se pudieron cargar los movimientos');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  /* -------------------------------------------------------------------------- */\n  /*                                 Handlers                                   */\n  /* -------------------------------------------------------------------------- */\n  const handleFilterChange = (newFilters: FilterValues) => {\n    setFilters(newFilters);\n    setPage(1);\n  };\n\n  const totalPages = Math.max(1, Math.ceil(totalCount / PAGE_SIZE));\n\n  const exportCSV = () => {\n    try {\n      let csv =\n        'Fecha,Tipo,Pallet,SKU,Tienda,Cantidad,Usuario,Notas\\n';\n      rows.forEach((r) => {\n        const fecha = new Date(r.created_at).toLocaleString('es-ES');\n        const notas = (r.notes || '').replace(/\"/g, '\"\"');\n        csv += `\"${fecha}\",\"${r.event_type}\",\"${r.pallet_code}\",\"${r.sku || ''}\",\"${r.tienda ||\n          ''}\",${r.qty || 0},\"${r.user_name}\",\"${notas}\"\\n`;\n      });\n\n      const blob = new Blob([csv], {\n        type: 'text/csv;charset=utf-8;',\n      });\n      const link = document.createElement('a');\n      link.href = URL.createObjectURL(blob);\n      link.download = `movimientos_${new Date()\n        .toISOString()\n        .split('T')[0]}.csv`;\n      link.style.visibility = 'hidden';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n\n      showToast('success', 'Exportado', 'Archivo CSV descargado');\n    } catch (err) {\n      console.error('Error exportando CSV:', err);\n      showToast('error', 'Error', 'No se pudo exportar');\n    }\n  };\n\n  /* -------------------------------------------------------------------------- */\n  /*                                   Render                                   */\n  /* -------------------------------------------------------------------------- */\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-gray-900\">\n            Reportes de Movimientos\n          </h2>\n          <p className=\"text-sm text-gray-500 mt-1\">\n            Historial completo de escaneos, confirmaciones y reversiones\n          </p>\n        </div>\n        <button\n          onClick={exportCSV}\n          disabled={rows.length === 0}\n          className=\"px-4 py-2.5 bg-teal-600 text-white rounded-lg text-sm font-medium hover:bg-teal-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap cursor-pointer\"\n        >\n          <i className=\"ri-download-line mr-2\"></i>\n          Exportar CSV\n        </button>\n      </div>\n\n      <MovimientosStats\n        totalMovimientos={stats.total}\n        totalConfirmaciones={stats.confirmaciones}\n        totalReversiones={stats.reversiones}\n        totalUnidades={stats.unidades}\n      />\n\n      <MovimientosFilters imports={imports} onFilterChange={handleFilterChange} />\n\n      <MovimientosTable\n        rows={rows}\n        loading={loading}\n        page={page}\n        totalPages={totalPages}\n        onPageChange={setPage}\n      />\n    </div>\n  );\n}\n"],"names":["eventTypes","MovimientosFilters","imports","onFilterChange","filters","setFilters","useState","updateFilter","key","value","newFilters","clearFilters","cleared","hasActiveFilters","jsxs","jsx","e","imp","MovimientosStats","totalMovimientos","totalConfirmaciones","totalReversiones","totalUnidades","safeNumber","num","stats","formatNumber","stat","eventTypeConfig","formatDateTime","dateStr","MovimientosTable","rows","loading","page","totalPages","onPageChange","safePage","row","config","_","i","pageNum","PAGE_SIZE","ReportesMovimientosPage","showToast","useToast","setImports","setRows","setLoading","setPage","totalCount","setTotalCount","setStats","useEffect","loadImports","loadMovimientos","loadStats","data","supabase","err","buildBaseQuery","useCallback","selectStr","forCount","query","term","totalQuery","totalAll","confQuery","totalConf","revQuery","totalRev","qtyData","sum","r","countQuery","count","from","to","error","mapped","handleFilterChange","exportCSV","csv","fecha","notas","blob","link"],"mappings":"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"}